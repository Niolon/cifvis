import{C as p,f as i}from"./widget-2y2Wuyar.js";function a(t,n="info"){const e=document.getElementById("status-message");e.textContent=t,e.className=`show ${n}`,n==="success"&&setTimeout(()=>{e.className=e.className.replace("show","")},2e3)}const r=new p(document.body);r.animate();r.onSelectionChange(t=>{const n=document.getElementById("selection-container");for(;n.firstChild;)n.firstChild.remove();t.forEach(e=>{const s=document.createElement("div");if(s.className="selection-box",s.style.border=`3px solid #${e.color.toString(16)}`,e.type==="atom")s.innerHTML=`
                <div class="selection-title">Atom: ${e.data.label}</div>
                <div class="selection-info">
                    <span>Type:</span><span>${e.data.atomType}</span>
                    <span>X:</span><span>${e.data.position.x.toFixed(4)}</span>
                    <span>Y:</span><span>${e.data.position.y.toFixed(4)}</span>
                    <span>Z:</span><span>${e.data.position.z.toFixed(4)}</span>
                </div>
            `;else if(e.type==="bond"){const o=i(e.data.bondLength,e.data.bondLengthSU);s.innerHTML=`
                <div class="selection-title">Bond: ${e.data.atom1Label} - ${e.data.atom2Label}</div>
                <div class="selection-info">
                    <span>Length:</span><span>${o} Å</span>
                </div>
            `}else if(e.type==="hbond"){const o=i(e.data.donorHydrogenDistance,e.data.donorHydrogenDistanceSU),c=i(e.data.acceptorHydrogenDistance,e.data.acceptorHydrogenDistanceSU),u=i(e.data.donorAcceptorDistance,e.data.donorAcceptorDistanceSU),y=i(e.data.hBondAngle,e.data.hBondAngleSU);s.innerHTML=`
                <div class="selection-title">H-Bond: ${e.data.donorAtomLabel} - ${e.data.hydrogenAtomLabel} ··· ${e.data.acceptorAtomLabel}</div>
                <div class="selection-info">
                    <span>D-H:</span><span>${o} Å</span>
                    <span>H···A:</span><span>${c} Å</span>
                    <span>D···A:</span><span>${u} Å</span>
                    <span>D-H···A:</span><span>${y}°</span>
                </div>
            `}n.appendChild(s)})});function g(){const t=document.getElementById("upload-button"),n=document.getElementById("cif-upload");t.addEventListener("click",()=>{n.click()}),n.addEventListener("change",async e=>{const s=e.target.files[0];if(s)try{a("Reading file...","info");const o=await s.text(),c=await r.loadStructure(o);c.success?(a("Structure loaded successfully","success"),d(),l()):a("Error loading structure: "+c.error,"error")}catch(o){console.error("Error reading file:",o),a("Error reading file: "+o.message,"error")}}),document.addEventListener("dragover",e=>{e.preventDefault(),e.stopPropagation()}),document.addEventListener("drop",async e=>{e.preventDefault(),e.stopPropagation();const s=e.dataTransfer.files[0];if(!s||!s.name.endsWith(".cif")){a("Please drop a CIF file","error");return}try{a("Reading file...","info");const o=await s.text(),c=await r.loadStructure(o);c.success?(a("Structure loaded successfully","success"),d(),l()):a("Error loading structure: "+c.error,"error")}catch(o){console.error("Error reading file:",o),a("Error reading file: "+o.message,"error")}})}function d(){const t=document.getElementById("selection-container");for(;t.firstChild;)t.firstChild.remove()}function m(){const t=document.getElementById("hydrogen-button");t.addEventListener("click",async()=>{const n=await r.cycleHydrogenMode();if(n.success){const e=t.querySelector("img");e.src=`svg/hydrogen-${n.mode}.svg`}d()})}function f(){const t=document.getElementById("disorder-button");t.addEventListener("click",async()=>{const n=await r.cycleDisorderMode();if(n.success){const e=t.querySelector("img");e.src=`svg/disorder-${n.mode}.svg`}d()})}function h(){const t=document.getElementById("symmetry-button");t.addEventListener("click",async()=>{const n=await r.cycleSymmetryMode();if(n.success){const e=t.querySelector("img");e.src=`svg/symmetry-${n.mode}.svg`}d()})}function v(){g(),m(),f(),h()}function l(){const t=document.getElementById("disorder-button"),n=r.hasDisorderGroups();if(t.style.display=n?"flex":"none",n){const o=t.querySelector("img");o.src=`svg/disorder-${r.modifiers.disorder.mode}.svg`}const e=document.getElementById("symmetry-button"),s=r.modifiers.symmetry.getApplicableModes(r.state.baseStructure).length>1;if(e.style.display=s?"flex":"none",s){const o=e.querySelector("img");o.src=`svg/symmetry-${r.modifiers.symmetry.mode}.svg`}}v();const E="/cifvis/";fetch(`${E}cif/disorder1.cif`).then(t=>t.text()).then(t=>{const n=r.loadStructure(t);return l(),n}).catch(t=>{console.error("Error loading initial structure:",t),a("Error loading initial structure. Try uploading your own CIF file.","error")});
